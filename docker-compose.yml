services:
  app:
    image: ubuntu
    # command: <<EOF
    # apt-get update
    # apt-get upgrade -y
    # ufw allow 443
    # ufw allow 80
    # ufw enable
    # curl -fsSL https://fnm.vercel.app/install | bash
    # source ~/.bashrc
    # fnm use --install-if-missing 20
    # npm --prefix /EnterData/src/server.js run start
    # EOF
    command: <<EOF
      bash -c
      apt-get update &&
      apt-get upgrade -y &&
      apt-get install -y curl unzip &&
      curl -fsSL https://fnm.vercel.app/install | bash &&
      source ~/.bashrc &&
      export PATH=/root/.local/share/fnm:$PATH &&
      eval $(fnm env) &&
      fnm use --install-if-missing 20 &&
      apt-get install -y npm &&
      npm --prefix /usr/share/app/enter-data/backend install &&
      npm --prefix /usr/share/app/enter-data/frontend install &&
      npm --prefix /usr/share/app/enter-data/backend run start &&
      npm --prefix /usr/share/app/enter-data/frontend run start
      EOF
    ports:
      - 8000:8000
    working_dir: /EnterData
    volumes:
      - ./src:/usr/share/app
    networks:

networks:
  default:
    driver: bridge